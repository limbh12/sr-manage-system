# 프로젝트 변경 이력 (History)

이 문서는 프로젝트의 주요 변경 사항을 기능별로 기록합니다.

## 2025-12-05

### 1. 개인정보 암호화 적용 (Personal Information Encryption)
- **AES-256 암호화 도입**:
  - `CryptoUtil` 유틸리티 클래스 구현: AES/CBC/PKCS5Padding 알고리즘 사용.
  - `EncryptConverter` 구현: JPA `AttributeConverter`를 활용하여 엔티티 저장/조회 시 자동 암호화/복호화 처리.
- **대상 엔티티 및 필드**:
  - `User`: 이름(`name`), 이메일(`email`), 전화번호(`phone`).
  - `OpenApiSurvey`: 담당자명(`contactName`), 담당자 연락처(`contactPhone`), 담당자 이메일(`contactEmail`).
  - `Sr`: 신청자명(`applicantName`), 신청자 연락처(`applicantPhone`).
- **목적**: 개인정보 보호 강화 및 보안 규정 준수.

### 2. 검색 로직 개선 (Search Logic Improvements)
- **암호화 필드 검색 문제 해결**:
  - 문제: 암호화된 데이터는 `LIKE` 연산자를 사용한 부분 일치 검색이 불가능함.
  - 해결: 암호화된 필드는 '정확히 일치(=)'하는 경우에만 검색되도록 로직 변경.
- **리포지토리 및 서비스 수정**:
  - `OpenApiSurveyRepository`: JPQL 쿼리를 수정하여 일반 필드(기관명, 부서명 등)는 `LIKE` 검색, 암호화 필드(담당자명, 연락처)는 `=` 검색을 수행하도록 파라미터 분리(`:keyword`, `:exactKeyword`).
  - `OpenApiSurveyService`: 검색어 입력 시 일반 검색어와 암호화된 검색어를 각각 생성하여 리포지토리에 전달. 이중 암호화 방지 로직 적용.

### 3. 프론트엔드 UI/UX 개선 (Frontend UI/UX Enhancements)
- **OPEN API 현황조사 검색 모달 (`SurveySearchModal`)**:
  - **데이터 표시 수정**: 기관명(`organization.name`)이 올바르게 표시되도록 객체 접근 경로 수정.
  - **사용성 개선**: '선택' 버튼뿐만 아니라 테이블의 행(Row) 전체를 클릭하여 선택할 수 있도록 이벤트 핸들러 추가 및 커서 스타일(`cursor: pointer`) 적용.
- **SR 등록 폼 (`SrForm`)**:
  - **입력 데이터 보존**: SR 등록 중 '검색 및 자동입력' 기능을 사용할 때, 이미 입력된 요청자 정보가 있다면 덮어쓰지 않고 유지하거나 사용자 의도에 따라 처리되도록 로직 개선.

### 4. 버그 수정 (Bug Fixes)
- **이중 암호화 방지**: 서비스 계층에서 암호화한 값을 JPA 리포지토리에 전달할 때, `EncryptConverter`가 다시 암호화를 수행하여 데이터가 손상되는 문제 해결 (서비스 계층에서는 평문 전달, JPA가 변환 담당).

### 5. 운영 환경 구성 (Production Environment Setup)
- **프로덕션 프로필 설정**: `application.yml`에 `prod` 프로필 추가 (H2 파일 모드, 로깅 설정).
- **시작 스크립트 작성**: `backend/scripts/start_prod.sh` 생성 (로그 관리, 백그라운드 실행).
- **데이터 초기화 로직 개선**: `DataInitializer` 수정하여 `prod` 프로필에서도 초기 데이터(`data.sql`)가 없을 경우 수동 실행하도록 변경.
- **문서 업데이트**: `docs/OPERATION_GUIDE.md`에 운영 환경 실행 가이드 추가.

### 6. UI 개선 (UI Improvements)
- **SR 상세 모달 확장**: `SrDetail.tsx`의 모달 너비를 확장하고 우측 이력 영역이 밀리지 않도록 스타일 수정.

### 7. 기타 (Others)
- **AI 지침 업데이트**: `.github/copilot-instructions.md`에 한글 지침 추가.
